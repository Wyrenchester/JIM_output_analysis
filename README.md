# **JIM Output Analysis**

##### This Python code is for analyzing particle tracking output generated by JIM: Immobilized Microscopy Suite (https://github.com/lilbutsa/JIM-Immobilized-Microscopy-Suite/tree/master). 

##### The script is designed to process up to 2 channels of fluorescence data from JIM, perform Hidden Markov Model (HMM) fitting, classify particle behavior, and generate summary Excel outputs and plots.




### Features

• GUI for user input: Select channel files, HMM fitting channel, and other parameters via a Tkinter interface.

• HMM-based particle classification into lysis, uncoating, and nonlytic events based on fluorescence behavior

• Alignment analysis:

&nbsp;	o Outputs an Excel file aligning the intensity of a user-selected channel at the second drop detected by HMM in the target channel.

&nbsp;	o User can specify the number of frames before the drop to include in analysis.

• Per-particle output:

&nbsp;	o Generates Excel tabs per particle with normalized intensity traces.

&nbsp;	o Saves plots of normalized intensity traces and HMM fits for visual inspection.

• Per-channel output:

&nbsp;	o Channel intensities for each behavior category are also outputted.




### Dependencies

• Python ≥ 3.9

• Libraries: numpy, pandas, matplotlib, scipy, hmmlearn, tkinter (usually included with Python), xlsxwriter

• To install dependencies with pip, run:

***pip install numpy pandas matplotlib scipy hmmlearn xlsxwriter***




### Usage

1. Launch the GUI by running the entire file (jim\_output\_analysis.py)
2. Select input files:
   o Red and Green channel Excel or CSV files exported from JIM.
   o Choose HMM fit channel (red or green).
3. (Optional) choose alignment channel and frames before drop for the alignment analysis.
4. Set parameters:
   o Seconds per frame.
   o Save plots: Yes/No.
   o (Optional) Output filename
5. Process the data:
   o The script will classify particles, perform HMM fitting, generate per-particle Excel files, category summaries, and optional alignment outputs.

*Plots are saved in a folder named <OutputName>\_plots if enabled.*

*Filenames will be automatically generated based on input file names, unless otherwise specified.*




### Outputs

<OutputName>\_particles.xlsx: Individual particle sheets with normalized intensity traces.

<OutputName>\_<Category>.xlsx: Pivoted summary for categories Lysis, Uncoating, Nonlytic.

<OutputName>\_Aligned.xlsx (if alignment enabled): Channel intensities aligned at the second drop.

<OutputName>\_plots/: Particle-wise plots of raw and HMM-fitted traces.




### Notes

• You do not have to modify the JIM output files. 

• HMM fitting can fail for highly noisy traces; these particles are saved separately in the 'bad' folder. Their intensities will not be outputted or included in analysis.

• Alignment analysis uses the second HMM-detected drop to synchronize traces.




### References

• JIM: Immobilized Microscopy Suite – https://github.com/lilbutsa/JIM-Immobilized-Microscopy-Suite/tree/master

• Hmmlearn for Unsupervised learning and inference of Hidden Markov Models: https://hmmlearn.readthedocs.io/en/latest/

# 



